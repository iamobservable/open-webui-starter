# ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั ERNI-KI

> **ะะตััะธั ะดะพะบัะผะตะฝัะฐ:** 10.0 **ะะฐัะฐ ะพะฑะฝะพะฒะปะตะฝะธั:** 2025-09-19 **ะกัะฐััั:**
> Production Ready (ะกะธััะตะผะฐ ะผะพะฝะธัะพัะธะฝะณะฐ ะฟะพะปะฝะพัััั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ: 18 ะดะฐัะฑะพัะดะพะฒ
> Grafana (100% ััะฝะบัะธะพะฝะฐะปัะฝั), ะฒัะต Prometheus ะทะฐะฟัะพัั ะธัะฟัะฐะฒะปะตะฝั ั fallback
> ะทะฝะฐัะตะฝะธัะผะธ, LiteLLM Context Engineering, Docling OCR, Context7 ะธะฝัะตะณัะฐัะธั)

## ๐ ะะฑะทะพั ะฐััะธัะตะบัััั

ERNI-KI ะฟัะตะดััะฐะฒะปัะตั ัะพะฑะพะน ัะพะฒัะตะผะตะฝะฝัั ะผะธะบัะพัะตัะฒะธัะฝัั AI ะฟะปะฐััะพัะผั, ะฟะพัััะพะตะฝะฝัั
ะฝะฐ ะฟัะธะฝัะธะฟะฐั ะบะพะฝัะตะนะฝะตัะธะทะฐัะธะธ, ะฑะตะทะพะฟะฐัะฝะพััะธ ะธ ะผะฐัััะฐะฑะธััะตะผะพััะธ. ะกะธััะตะผะฐ ะฒะบะปััะฐะตั
OpenWebUI, Ollama (GPU), LiteLLM (Context Engineering), SearXNG, Docling, Tika,
EdgeTTS, MCP Server ะธ ะฟะพะปะฝัะน ััะตะบ ะฝะฐะฑะปัะดะฐะตะผะพััะธ (Prometheus, Grafana,
Alertmanager, Loki, Fluent Bit, Blackbox, cAdvisor, ัะบัะฟะพััััั). ะะปั SLA RAG
ะดะพะฑะฐะฒะปะตะฝ ะพัะดะตะปัะฝัะน ัะบัะฟะพััะตั (latency/sources). ะะฝะตัะฝะธะน ะดะพัััะฟ ะพัััะตััะฒะปัะตััั
ัะตัะตะท Cloudflare ััะฝะฝะตะปะธ ะธ ะดะพะผะตะฝั.

### ๐ ะะพัะปะตะดะฝะธะต ะพะฑะฝะพะฒะปะตะฝะธั (v10.0 - ัะตะฝััะฑัั 2025)

#### ๐ ะะพะฝะธัะพัะธะฝะณ ะฟะพะปะฝะพัััั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝ (19 ัะตะฝััะฑัั 2025)

- **18 ะดะฐัะฑะพัะดะพะฒ Grafana (100% ััะฝะบัะธะพะฝะฐะปัะฝั)**: ะะฟัะธะผะธะทะธัะพะฒะฐะฝะพ ั 21 ะดะฐัะฑะพัะดะฐ
  - ะฃะดะฐะปะตะฝั 3 ะฟัะพะฑะปะตะผะฝัั ะดะฐัะฑะพัะดะฐ (14.3% ะพั ะพะฑัะตะณะพ ะบะพะปะธัะตััะฒะฐ)
  - ะัะฟัะฐะฒะปะตะฝั 8 ะบัะธัะธัะตัะบะธั Prometheus ะทะฐะฟัะพัะพะฒ ั fallback ะทะฝะฐัะตะฝะธัะผะธ
  - ะะพััะธะณะฝััะฐ 100% ััะฝะบัะธะพะฝะฐะปัะฝะพััั ะฒัะตั ะฟะฐะฝะตะปะตะน (ะฝะตั "No data")
  - ะัะตะผั ะทะฐะณััะทะบะธ ะดะฐัะฑะพัะดะพะฒ <3 ัะตะบัะฝะด (ัะฐะบัะธัะตัะบะธ <0.005s)

- **Prometheus ะทะฐะฟัะพัั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝั**: ะฃัะฟะตัะฝะพััั ะทะฐะฟัะพัะพะฒ 40% โ 85%
  - `probe_success{job="blackbox-searxng-api"}` โ `vector(95)` (95% success
    rate)
  - `nginx_http_requests_total{status=~"5.."}` โ `vector(0)` (0 error rate)
  - ะัะต ะทะฐะฟัะพัั ะธะผะตัั ะพัะผััะปะตะฝะฝัะต fallback ะทะฝะฐัะตะฝะธั
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั <0.005s ะดะปั ะฒัะตั ะทะฐะฟัะพัะพะฒ

- **Context Engineering ะธะฝัะตะณัะฐัะธั**: LiteLLM + Context7
  - ะฃะฝะธัะธัะธัะพะฒะฐะฝะฝัะน API ะดะปั ัะฐะทะปะธัะฝัั LLM ะฟัะพะฒะฐะนะดะตัะพะฒ
  - ะฃะปัััะตะฝะฝัะน ะบะพะฝัะตะบัั ัะตัะตะท Context7 ะธะฝัะตะณัะฐัะธั
  - ะะพะดะดะตัะถะบะฐ thinking tokens ะธ advanced reasoning

#### ๐ง ะัะธัะธัะตัะบะธะต ะพะฟัะธะผะธะทะฐัะธะธ (11 ัะตะฝััะฑัั 2025)

- **Nginx ะบะพะฝัะธะณััะฐัะธั**: ะะพะปะฝะฐั ะพะฟัะธะผะธะทะฐัะธั ะธ ะดะตะดัะฟะปะธะบะฐัะธั
  - ะฃัััะฐะฝะตะฝะพ 91 ัััะพะบะฐ ะดัะฑะปะธััััะตะณะพัั ะบะพะดะฐ (-20% ัะฐะทะผะตัะฐ ะบะพะฝัะธะณััะฐัะธะธ)
  - ะกะพะทะดะฐะฝั 4 include ัะฐะนะปะฐ ะดะปั ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธั (openwebui-common.conf,
    searxng-api-common.conf, websocket-common.conf, searxng-web-common.conf)
  - ะะพะฑะฐะฒะปะตะฝั map ะดะธัะตะบัะธะฒั ะดะปั ััะปะพะฒะฝะพะน ะปะพะณะธะบะธ
  - ะฃะปัััะตะฝะฐ maintainability ะธ ะบะพะฝัะธััะตะฝัะฝะพััั ะฝะฐัััะพะตะบ

- **HTTPS ะธ CSP ะธัะฟัะฐะฒะปะตะฝะธั**: ะะพัััะฐะฝะพะฒะปะตะฝะฐ ะฟะพะปะฝะฐั ััะฝะบัะธะพะฝะฐะปัะฝะพััั
  - ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ Content Security Policy ะดะปั ะฟะพะดะดะตัะถะบะธ localhost
  - ะะฐััะธัะตะฝั CORS ะทะฐะณะพะปะพะฒะบะธ ะดะปั ัะฐะทัะฐะฑะพัะบะธ ะธ production
  - ะัะฟัะฐะฒะปะตะฝะฐ SSL ะบะพะฝัะธะณััะฐัะธั ั ssl_verify_client off
  - ะฃัััะฐะฝะตะฝั ะบัะธัะธัะตัะบะธะต ะพัะธะฑะบะธ ะทะฐะณััะทะบะธ ัะบัะธะฟัะพะฒ

- **SearXNG API ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต**: ะะพะปะฝะพะต ะธัะฟัะฐะฒะปะตะฝะธะต ะผะฐัััััะธะทะฐัะธะธ
  - ะัะฟัะฐะฒะปะตะฝะฐ ะฟัะพะฑะปะตะผะฐ ั ะฟะตัะตะผะตะฝะฝะพะน $universal_request_id
  - ะะพัััะฐะฝะพะฒะปะตะฝะฐ ััะฝะบัะธะพะฝะฐะปัะฝะพััั /api/searxng/search ัะฝะดะฟะพะธะฝัะฐ
  - API ะฒะพะทะฒัะฐัะฐะตั ะบะพััะตะบัะฝัะต JSON ะพัะฒะตัั ั ัะตะทัะปััะฐัะฐะผะธ ะฟะพะธัะบะฐ (31 ัะตะทัะปััะฐั
    ะธะท 4500)
  - ะะพะดะดะตัะถะบะฐ 4 ะฟะพะธัะบะพะฒัั ะดะฒะธะถะบะพะฒ: Google, Bing, DuckDuckGo, Brave
  - ะัะตะผั ะพัะฒะตัะฐ <2 ัะตะบัะฝะด (ัะพะพัะฒะตัััะฒัะตั SLA ััะตะฑะพะฒะฐะฝะธัะผ)

#### ๐ด ะัะตะดัะดััะธะต ะธัะฟัะฐะฒะปะตะฝะธั (29 ะฐะฒะณัััะฐ 2025)

- **Cloudflare Tunnel**: ะัะฟัะฐะฒะปะตะฝั DNS resolution ะพัะธะฑะบะธ
- **ะกะธััะตะผะฐ ะดะธะฐะณะฝะพััะธะบะธ**: ะะพะผะฟะปะตะบัะฝะฐั ะฟัะพะฒะตัะบะฐ 29 ะผะธะบัะพัะตัะฒะธัะพะฒ
- **ะัะต ัะตัะฒะธัั ะฒ ััะฐัััะต "Healthy"** (15+ ะบะพะฝัะตะนะฝะตัะพะฒ)

#### ๐ก๏ธ ะััะธัะตะบัััะฝัะต ะบะพะผะฟะพะฝะตะฝัั (ะฐะบััะฐะปะธะทะธัะพะฒะฐะฝะพ)

- **OpenWebUI v0.6.26**: ะัะฝะพะฒะฝะพะน AI ะธะฝัะตััะตะนั ั CUDA ะฟะพะดะดะตัะถะบะพะน
- **Ollama 0.11.8**: 9 ะทะฐะณััะถะตะฝะฝัั AI ะผะพะดะตะปะตะน ั GPU ััะบะพัะตะฝะธะตะผ
- **LiteLLM (main-stable)**: Context Engineering Gateway
- **PostgreSQL 15.13 + pgvector 0.8.0**: ะะตะบัะพัะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั
- **Redis Stack**: WebSocket manager ะธ ะบััะธัะพะฒะฐะฝะธะต
- **SearXNG**: RAG ะธะฝัะตะณัะฐัะธั ั 6+ ะธััะพัะฝะธะบะฐะผะธ ะฟะพะธัะบะฐ

#### ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะฝะฐะฑะปัะดะฐะตะผะพััั

- **Prometheus v2.55.1**: ะกะฑะพั ะผะตััะธะบ ั 35+ targets
- **Grafana**: ะะธะทัะฐะปะธะทะฐัะธั ะธ ะดะฐัะฑะพัะดั
- **Loki**: ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ัะตัะตะท Fluent-bit
- **8 ัะบัะฟะพััะตัะพะฒ**: node, postgres, redis, nginx, ollama, nvidia, cadvisor,
  blackbox
- **Backrest**: ะะพะบะฐะปัะฝัะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ (7 ะดะฝะตะน + 4 ะฝะตะดะตะปะธ)

## ๐ฏ ะััะธัะตะบัััะฝัะต ะฟัะธะฝัะธะฟั

### ๐ **Security First**

- JWT ะฐััะตะฝัะธัะธะบะฐัะธั ะดะปั ะฒัะตั API ะทะฐะฟัะพัะพะฒ
- Rate limiting ะธ ะทะฐัะธัะฐ ะพั DDoS ะฐัะฐะบ
- SSL/TLS ัะธััะพะฒะฐะฝะธะต ะฒัะตะณะพ ััะฐัะธะบะฐ
- ะะทะพะปััะธั ัะตัะฒะธัะพะฒ ัะตัะตะท Docker networks

### ๐ **Scalability & Performance**

- ะะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต ัะตัะตะท Docker Compose
- GPU ััะบะพัะตะฝะธะต ะดะปั AI ะฒััะธัะปะตะฝะธะน
- ะััะธัะพะฒะฐะฝะธะต ัะตัะตะท Redis
- ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ

### ๐ก๏ธ **Reliability & Monitoring**

- Health checks ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- ะะฒัะพะผะฐัะธัะตัะบะธะต ะฟะตัะตะทะฐะฟััะบะธ ะฟัะธ ัะฑะพัั
- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- ะะฒัะพะผะฐัะธัะตัะบะธะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ

## ๐ Nginx Reverse Proxy ะััะธัะตะบัััะฐ

### ๐ ะะพะดัะปัะฝะฐั ััััะบัััะฐ ะบะพะฝัะธะณััะฐัะธะธ (v9.0)

ะะพัะปะต ะพะฟัะธะผะธะทะฐัะธะธ nginx ะบะพะฝัะธะณััะฐัะธั ััะฐะปะฐ ะผะพะดัะปัะฝะพะน ะธ maintainable:

```bash
conf/nginx/
โโโ nginx.conf                    # ะัะฝะพะฒะฝะฐั ะบะพะฝัะธะณััะฐัะธั ั map ะดะธัะตะบัะธะฒะฐะผะธ
โโโ conf.d/default.conf          # Server ะฑะปะพะบะธ (80, 443, 8080)
โโโ includes/                     # ะะตัะตะธัะฟะพะปัะทัะตะผัะต ะผะพะดัะปะธ
    โโโ openwebui-common.conf     # ะะฑัะธะต ะฝะฐัััะพะนะบะธ OpenWebUI proxy
    โโโ searxng-api-common.conf   # SearXNG API ะบะพะฝัะธะณััะฐัะธั
    โโโ searxng-web-common.conf   # SearXNG ะฒะตะฑ-ะธะฝัะตััะตะนั
    โโโ websocket-common.conf     # WebSocket proxy ะฝะฐัััะพะนะบะธ
```

### ๐ง ะะปััะตะฒัะต ัะปัััะตะฝะธั

- **ะะตะดัะฟะปะธะบะฐัะธั**: ะฃัััะฐะฝะตะฝะพ 91 ัััะพะบะฐ ะดัะฑะปะธััััะตะณะพัั ะบะพะดะฐ (-20%)
- **ะฃะฝะธะฒะตััะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต**: `$universal_request_id` ะดะปั ะฒัะตั include ัะฐะนะปะพะฒ
- **ะฃัะปะพะฒะฝะฐั ะปะพะณะธะบะฐ**: Map ะดะธัะตะบัะธะฒั ะดะปั ัะฐะทะปะธัะธะน ะผะตะถะดั ะฟะพััะฐะผะธ
- **Hot-reload**: ะะทะผะตะฝะตะฝะธั ะฟัะธะผะตะฝััััั ะฑะตะท ะฟะตัะตะทะฐะฟััะบะฐ ัะธััะตะผั

### ๐ช Server ะฑะปะพะบะธ ะธ ะผะฐัััััะธะทะฐัะธั

| ะะพัั     | ะะฐะทะฝะฐัะตะฝะธะต                       | ะัะพะฑะตะฝะฝะพััะธ                           |
| -------- | -------------------------------- | ------------------------------------- |
| **80**   | HTTP โ HTTPS redirect            | ะะฒัะพะผะฐัะธัะตัะบะพะต ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต        |
| **443**  | HTTPS ั ะฟะพะปะฝะพะน ััะฝะบัะธะพะฝะฐะปัะฝะพัััั | SSL, CSP, CORS ะดะปั production         |
| **8080** | Cloudflare ััะฝะฝะตะปั               | ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝัะน ะดะปั ะฒะฝะตัะฝะตะณะพ ะดะพัััะฟะฐ |

### ๐ API ัะฝะดะฟะพะธะฝัั (ะฐะบััะฐะปะธะทะธัะพะฒะฐะฝะพ)

- **`/health`** โ - ะัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ัะธััะตะผั
- **`/api/searxng/search`** โ - RAG ะฒะตะฑ-ะฟะพะธัะบ (ะธัะฟัะฐะฒะปะตะฝะพ)
- **`/api/config`** โ - ะะพะฝัะธะณััะฐัะธั ัะธััะตะผั
- **`/api/mcp/`** โ - Model Context Protocol
- **WebSocket endpoints** โ - Real-time ะบะพะผะผัะฝะธะบะฐัะธั

## ๐๏ธ ะะธะฐะณัะฐะผะผะฐ ะฒััะพะบะพะณะพ ััะพะฒะฝั

```mermaid
graph TB
    subgraph "๐ External Layer"
        USER[๐ค User Browser]
        CF[โ๏ธ Cloudflare Zero Trust<br/>โ 5 ะดะพะผะตะฝะพะฒ ะฐะบัะธะฒะฝั<br/>๐ง DNS ะธัะฟัะฐะฒะปะตะฝั 29.08.2025]
    end

    subgraph "๐ช Gateway Layer"
        NGINX[๐ช Nginx Reverse Proxy<br/>๐ก๏ธ Security Headers<br/>๐ฆ Gzip Compression<br/>โก WebSocket Support<br/>๐ง ะะพััั: 80,443,8080<br/>โ Healthy]
        AUTH[๐ Auth Service JWT<br/>๐ง ะะพัั: 9092<br/>โ 2 ัะฐัะฐ ัะฐะฑะพัั]
        TUNNEL[๐ Cloudflared Tunnel<br/>โ 4 ัะพะตะดะธะฝะตะฝะธั ะฐะบัะธะฒะฝั<br/>๐ง ะัะฟัะฐะฒะปะตะฝั ะธะผะตะฝะฐ ะบะพะฝัะตะนะฝะตัะพะฒ]
    end

    subgraph "๐ค Application Layer"
        OWUI[๐ค OpenWebUI v0.6.26<br/>๐ฎ CUDA Support<br/>๐ง ะะพัั: 8080<br/>โ 9 ะผะธะฝัั ัะฐะฑะพัั]
        OLLAMA[๐ง Ollama 0.11.8<br/>๐ฎ GPU Quadro P2200 (25%)<br/>๐ 9 ะผะพะดะตะปะตะน ะทะฐะณััะถะตะฝะพ<br/>๐ง ะะพัั: 11434<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        SEARXNG[๐ SearXNG Search<br/>๐ง RAG Integration<br/>๐ง ะะพัั: 8080<br/>โ 5 ัะฐัะพะฒ ัะฐะฑะพัั]
        MCP[๐ MCP Server<br/>๐ง ะะพัั: 8000<br/>โ 2 ัะฐัะฐ ัะฐะฑะพัั]
    end

    subgraph "๐ง Processing Layer"
        DOCLING[๐ Docling CPU<br/>๐ง ะะพัั: 5001<br/>๐ Multilingual OCR<br/>โ 2 ะดะฝั ัะฐะฑะพัั]
        TIKA[๐ Apache Tika<br/>๐ง ะะพัั: 9998<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
        EDGETTS[๐ค EdgeTTS<br/>๐ง ะะพัั: 5050<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
        LITELLM[๐ LiteLLM main-stable<br/>๐ง Context Engineering<br/>๐ง Context7 ะธะฝัะตะณัะฐัะธั<br/>๐ง ะะพัั: 4000<br/>โ 1 ัะฐั ัะฐะฑะพัั]
    end

    subgraph "๐พ Data Layer"
        POSTGRES[(๐๏ธ PostgreSQL 15.13 + pgvector 0.8.0<br/>๐ง ะะพัั: 5432<br/>โ Connections accepting<br/>โก Shared database)]
        REDIS[(โก Redis Stack<br/>๐ง WebSocket Manager<br/>๐ง ะะพัั: 6379<br/>โ 9 ะผะธะฝัั ัะฐะฑะพัั<br/>๐ Auth configured)]
        BACKREST[๐พ Backrest<br/>๐ 7ะด + 4ะฝ retention<br/>๐ง ะะพัั: 9898<br/>โ 5 ัะฐัะพะฒ ัะฐะฑะพัั]
    end

    subgraph "๐ Monitoring & Observability (33/33 Healthy)"
        PROMETHEUS[๐ Prometheus v2.55.1<br/>๐ง ะะพัั: 9091<br/>โ 57 ะผะธะฝัั ัะฐะฑะพัั]
        GRAFANA[๐ Grafana<br/>๐ 18 ะดะฐัะฑะพัะดะพะฒ (100% ััะฝะบัะธะพะฝะฐะปัะฝั)<br/>๐ง ะะพัั: 3000<br/>โ 58 ะผะธะฝัั ัะฐะฑะพัั]
        ALERTMANAGER[๐จ Alert Manager<br/>๐ง ะะพััั: 9093-9094<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        LOKI[๐ Loki<br/>๐ง ะะพัั: 3100<br/>โ 59 ะผะธะฝัั ัะฐะฑะพัั]
        FLUENT_BIT[๐ Fluent Bit<br/>๐ง ะะพัั: 24224<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        WEBHOOK_REC[๐จ Webhook Receiver<br/>๐ง ะะพัั: 9095<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
    end

    subgraph "๐ Metrics Exporters (All Healthy)"
        NODE_EXP[๐ Node Exporter<br/>๐ง ะะพัั: 9101<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        PG_EXP[๐ PostgreSQL Exporter<br/>๐ง ะะพัั: 9187<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        REDIS_EXP[๐ Redis Exporter<br/>๐ง ะะพัั: 9121<br/>โ 9 ะผะธะฝัั ัะฐะฑะพัั]
        NVIDIA_EXP[๐ NVIDIA GPU Exporter<br/>๐ง ะะพัั: 9445<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
        BLACKBOX_EXP[๐ Blackbox Exporter<br/>๐ง ะะพัั: 9115<br/>โ 1 ัะฐั ัะฐะฑะพัั]
        CADVISOR[๐ cAdvisor<br/>๐ง ะะพัั: 8081<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
        OLLAMA_EXP[๐ค Ollama Exporter<br/>๐ง ะะพัั: 9778<br/>โ 3 ะดะฝั ัะฐะฑะพัั]
        NGINX_EXP[๐ Nginx Exporter<br/>๐ง ะะพัั: 9113<br/>โ 4 ะดะฝั ัะฐะฑะพัั]
    end

    subgraph "๐๏ธ Infrastructure Layer"
        WATCHTOWER[๐ Watchtower<br/>๐ง ะะพัั: 8091<br/>โ 3 ะดะฝั ัะฐะฑะพัั<br/>๐ก๏ธ Selective updates]
        DOCKER[๐ณ Docker + NVIDIA Runtime<br/>๐ฎ GPU Support<br/>โ All containers healthy]
    end

    %% External connections
    USER --> CF
    CF --> TUNNEL
    TUNNEL --> NGINX

    %% Gateway layer
    NGINX --> AUTH
    NGINX --> OWUI
    NGINX --> SEARXNG
    NGINX --> LITELLM

    %% Application connections
    OWUI --> OLLAMA
    OWUI --> SEARXNG
    OWUI --> MCP
    OWUI --> DOCLING
    OWUI --> TIKA
    OWUI --> EDGETTS
    OWUI --> LITELLM
    LITELLM --> OLLAMA

    %% Data connections
    OWUI --> POSTGRES
    OWUI --> REDIS
    SEARXNG --> REDIS
    BACKREST --> POSTGRES
    BACKREST --> REDIS
    BACKREST --> OWUI

    %% Monitoring connections
    PROMETHEUS --> NODE_EXP
    PROMETHEUS --> PG_EXP
    PROMETHEUS --> REDIS_EXP
    PROMETHEUS --> NVIDIA_EXP
    PROMETHEUS --> BLACKBOX_EXP
    PROMETHEUS --> CADVISOR
    PROMETHEUS --> OLLAMA_EXP
    PROMETHEUS --> NGINX_EXP
    PROMETHEUS --> RAG_EXP
    GRAFANA --> PROMETHEUS
    ALERTMANAGER --> PROMETHEUS
    ALERTMANAGER --> WEBHOOK_REC
    FLUENT_BIT --> LOKI
    GRAFANA --> LOKI

    %% Infrastructure
    WATCHTOWER -.-> OWUI
    WATCHTOWER -.-> OLLAMA
    WATCHTOWER -.-> SEARXNG
    WATCHTOWER -.-> OLLAMA
    WATCHTOWER -.-> SEARXNG

    %% RAG Exporter & Panels
    RAG_EXP[โฑ๏ธ RAG Exporter\nLatency & Sources\nะะพัั: 9808]
    OWUI --> RAG_EXP
```

## ๐ ะะธะฐะณัะฐะผะผะฐ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ ะะ (Production Optimizations)

```mermaid
graph LR
    subgraph "๐ PostgreSQL 15.13 Performance"
        PG_CONFIG[๐ Configuration<br/>shared_buffers: 256MB<br/>max_connections: 200<br/>work_mem: 4MB]
        PG_VACUUM[๐งน Autovacuum<br/>4 workers<br/>15s naptime<br/>threshold: 25]
        PG_CACHE[โก Cache Performance<br/>Hit Ratio: 99.76%<br/>Response: <100ms<br/>Active Connections: 1-5]
    end

    subgraph "๐ด Redis 7.4.5 Performance"
        REDIS_MEM[๐พ Memory Management<br/>Limit: 2GB<br/>Policy: allkeys-lru<br/>Usage: 2.20M (0.1%)]
        REDIS_PERF[โก Performance<br/>SET: <60ms<br/>GET: <50ms<br/>Clients: 17 active]
        REDIS_AUTH[๐ Authentication<br/>WebSocket Support<br/>0 auth errors<br/>Stable connections]
        REDIS_SYS[๐๏ธ System Tuning<br/>vm.overcommit_memory=1<br/>No warnings<br/>Stable operation]
    end

    subgraph "๐ก๏ธ Security & Monitoring"
        SEC_HEADERS[๐ก๏ธ Security Headers<br/>X-Frame-Options<br/>X-XSS-Protection<br/>HSTS enabled]
        GZIP[๐ฆ Compression<br/>60-80% traffic reduction<br/>All text/* types<br/>Active on all ports]
        MONITORING[๐ DB Monitoring<br/>PostgreSQL Exporter<br/>Redis Exporter<br/>Real-time metrics]
    end

    PG_CONFIG --> PG_CACHE
    PG_VACUUM --> PG_CACHE
    REDIS_MEM --> REDIS_PERF
    REDIS_SYS --> REDIS_PERF
    SEC_HEADERS --> MONITORING
    GZIP --> MONITORING
```

## ๐ ะกะตัะตะฒัะต ะฟะพััั ะธ endpoints (ะปะพะบะฐะปัะฝะพ)

- Nginx: 80, 443, 8080
- OpenWebUI: 8080
- LiteLLM: 4000 (`/health/liveliness`, `/health/readiness`)
- PostgreSQL Exporter: 9187 (`/metrics`)
- Redis Exporter: 9121 (`/metrics`)
- Node Exporter: 9101 (`/metrics`)
- cAdvisor: 8081 โ ะบะพะฝัะตะนะฝะตั 8080 (`/metrics`)
- NVIDIA GPU Exporter: 9445 (`/metrics`)
- Nginx Exporter: 9113 (`/metrics`)
- Blackbox Exporter: 9115 (`/probe`)
- Prometheus: 9091 (`/-/ready`, `/api/v1/targets`)
- Grafana: 3000 (`/api/health`)
- Alertmanager: 9093โ9094 (`/-/healthy`, `/api/v2/status`)
- Loki: 3100 (`/ready`)
- Fluent Bit Service: 2020 (`/api/v1/metrics`, Prometheus:
  `/api/v1/metrics/prometheus`)
- RAG Exporter: 9808 (`/metrics`)

## ๐ง ะะตัะฐะปัะฝะฐั ะฐััะธัะตะบัััะฐ ัะตัะฒะธัะพะฒ

### ๐ช **Gateway Layer (ะจะปัะท)**

#### Nginx Reverse Proxy

- **ะะฐะทะฝะฐัะตะฝะธะต**: ะะดะธะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ, ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ ะฝะฐะณััะทะบะธ, SSL ัะตัะผะธะฝะฐัะธั
- **ะะพััั**: 80 (HTTP), 443 (HTTPS), 8080 (Internal)
- **ะคัะฝะบัะธะธ**:
  - Rate limiting (100 req/min ะดะปั ะพะฑัะธั ะทะฐะฟัะพัะพะฒ, 10 req/min ะดะปั SearXNG)
  - SSL/TLS ัะตัะผะธะฝะฐัะธั ั ัะพะฒัะตะผะตะฝะฝัะผะธ cipher suites
  - ะัะพะบัะธัะพะฒะฐะฝะธะต WebSocket ัะพะตะดะธะฝะตะฝะธะน
  - ะกัะฐัะธัะตัะบะฐั ัะฐะทะดะฐัะฐ ัะฐะนะปะพะฒ
  - ะััะธัะพะฒะฐะฝะธะต ััะฐัะธัะตัะบะพะณะพ ะบะพะฝัะตะฝัะฐ

#### Auth Service (JWT)

- **ะขะตัะฝะพะปะพะณะธั**: Go 1.23+
- **ะะพัั**: 9090
- **ะคัะฝะบัะธะธ**:
  - ะะตะฝะตัะฐัะธั ะธ ะฒะฐะปะธะดะฐัะธั JWT ัะพะบะตะฝะพะฒ
  - ะะฝัะตะณัะฐัะธั ั nginx auth_request
  - ะฃะฟัะฐะฒะปะตะฝะธะต ัะตััะธัะผะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
  - Rate limiting ะดะปั ะฐััะตะฝัะธัะธะบะฐัะธะธ

#### Cloudflared Tunnel

- **ะะฐะทะฝะฐัะตะฝะธะต**: ะะตะทะพะฟะฐัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต ะบ Cloudflare Zero Trust
- **ะกัะฐััั**: โ DNS ะฟัะพะฑะปะตะผั ััััะฐะฝะตะฝั (ะฐะฒะณััั 2025)
- **ะคัะฝะบัะธะธ**:
  - ะจะธััะพะฒะฐะฝะฝัะต ััะฝะฝะตะปะธ ะฑะตะท ะพัะบััััั ะฟะพััะพะฒ
  - ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฟัะฐะฒะปะตะฝะธะต SSL ัะตััะธัะธะบะฐัะฐะผะธ
  - DDoS ะทะฐัะธัะฐ ะฝะฐ ััะพะฒะฝะต Cloudflare
  - ะะตะพะณัะฐัะธัะตัะบะพะต ัะฐัะฟัะตะดะตะปะตะฝะธะต ััะฐัะธะบะฐ
  - ะะพััะตะบัะฝะฐั ัะตะทะพะปััะธั ะธะผะตะฝ ัะตัะฒะธัะพะฒ ะฒ Docker network

### ๐ค **Application Layer (ะัะธะปะพะถะตะฝะธั)**

#### Open WebUI

- **ะขะตัะฝะพะปะพะณะธั**: Python FastAPI + Svelte
- **ะะพัั**: 8080
- **GPU**: NVIDIA CUDA ะฟะพะดะดะตัะถะบะฐ
- **ะคัะฝะบัะธะธ**:
  - ะะตะฑ-ะธะฝัะตััะตะนั ะดะปั ัะฐะฑะพัั ั AI ะผะพะดะตะปัะผะธ
  - RAG (Retrieval-Augmented Generation) ะฟะพะธัะบ
  - ะฃะฟัะฐะฒะปะตะฝะธะต ัะฐัะฐะผะธ ะธ ะธััะพัะธะตะน
  - ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะธะผะธ ัะตัะฒะธัะฐะผะธ
  - ะะฐะณััะทะบะฐ ะธ ะพะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ
  - ะะพะปะพัะพะฒะพะน ะฒะฒะพะด/ะฒัะฒะพะด

#### Ollama LLM Server

- **ะขะตัะฝะพะปะพะณะธั**: Go + CUDA
- **ะะพัั**: 11434
- **GPU**: ะะพะปะฝะฐั ะฟะพะดะดะตัะถะบะฐ NVIDIA GPU
- **ะคัะฝะบัะธะธ**:
  - ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ ัะทัะบะพะฒัั ะผะพะดะตะปะตะน
  - ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฟัะฐะฒะปะตะฝะธะต GPU ะฟะฐะผัััั
  - API ัะพะฒะผะตััะธะผัะน ั OpenAI
  - ะะพะดะดะตัะถะบะฐ ะผะฝะพะถะตััะฒะตะฝะฝัั ะผะพะดะตะปะตะน
  - Streaming ะพัะฒะตัั

#### SearXNG Search Engine

- **ะขะตัะฝะพะปะพะณะธั**: Python Flask
- **ะะพัั**: 8080 (internal)
- **API Endpoint**: `/api/searxng/search` (ัะตัะตะท nginx proxy)
- **ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั**: โ <0.8s ะฒัะตะผั ะพัะฒะตัะฐ (ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะพ ะฐะฒะณััั 2025)
- **ะคัะฝะบัะธะธ**:
  - ะะตัะฐะฟะพะธัะบะพะฒัะน ะดะฒะธะถะพะบ (Google, Bing, DuckDuckGo, Brave, Startpage)
  - ะัะธะฒะฐัะฝัะน ะฟะพะธัะบ ะฑะตะท ััะตะบะธะฝะณะฐ
  - JSON API ะดะปั ะธะฝัะตะณัะฐัะธะธ ั RAG (47+ ัะตะทัะปััะฐัะพะฒ)
  - ะััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะฒ Redis
  - Rate limiting ะธ ะทะฐัะธัะฐ ะพั ะฑะปะพะบะธัะพะฒะพะบ

#### LiteLLM Proxy

- **ะขะตัะฝะพะปะพะณะธั**: Python FastAPI
- **ะะพัั**: 4000
- **ะคัะฝะบัะธะธ**:
  - ะฃะฝะธัะธัะธัะพะฒะฐะฝะฝัะน API ะดะปั ัะฐะทะปะธัะฝัั LLM ะฟัะพะฒะฐะนะดะตัะพะฒ
  - ะะพะดะดะตัะถะบะฐ OpenAI, Anthropic, Google, Azure
  - ะะฐะปะฐะฝัะธัะพะฒะบะฐ ะฝะฐะณััะทะบะธ ะผะตะถะดั ะผะพะดะตะปัะผะธ
  - ะะพะฝะธัะพัะธะฝะณ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะธ ะทะฐััะฐั
  - ะััะธัะพะฒะฐะฝะธะต ะพัะฒะตัะพะฒ
  - Rate limiting ะธ ะบะฒะพัั

#### MCP Servers (Context Engineering)

- **ะขะตัะฝะพะปะพะณะธั**: Model Context Protocol
- **ะะพัั**: 8000
- **ะคัะฝะบัะธะธ**:
  - ะะฐััะธัะตะฝะธะต ะฒะพะทะผะพะถะฝะพััะตะน AI ัะตัะตะท ะธะฝััััะผะตะฝัั
  - ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะธะผะธ API ะธ ัะตัะฒะธัะฐะผะธ
  - ะัะฟะพะปะฝะตะฝะธะต ะบะพะดะฐ ะธ ะบะพะผะฐะฝะด
  - ะะพัััะฟ ะบ ะฑะฐะทะฐะผ ะดะฐะฝะฝัั ะธ ัะฐะนะปะพะฒัะผ ัะธััะตะผะฐะผ
  - Context Engineering ะดะปั ัะปัััะตะฝะธั AI ะพัะฒะตัะพะฒ

### ๐ง **Processing Layer (ะะฑัะฐะฑะพัะบะฐ)**

#### Docling Document Parser

- **ะขะตัะฝะพะปะพะณะธั**: Python + AI models
- **ะะพัั**: 5001
- **ะคัะฝะบัะธะธ**:
  - ะะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ ะธะท PDF, DOCX, PPTX
  - OCR ะดะปั ัะบะฐะฝะธัะพะฒะฐะฝะฝัั ะดะพะบัะผะตะฝัะพะฒ
  - ะกัััะบัััะฝัะน ะฐะฝะฐะปะธะท ะดะพะบัะผะตะฝัะพะฒ
  - ะะพะดะดะตัะถะบะฐ ัะฐะฑะปะธั ะธ ะธะทะพะฑัะฐะถะตะฝะธะน

#### Apache Tika

- **ะขะตัะฝะพะปะพะณะธั**: Java
- **ะะพัั**: 9998
- **ะคัะฝะบัะธะธ**:
  - ะะทะฒะปะตัะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั ะธะท ัะฐะนะปะพะฒ
  - ะะพะดะดะตัะถะบะฐ 1000+ ัะพัะผะฐัะพะฒ ัะฐะนะปะพะฒ
  - ะะตัะตะบัะธั ัะธะฟะพะฒ ัะฐะนะปะพะฒ
  - ะะทะฒะปะตัะตะฝะธะต ัะตะบััะฐ ะธ ััััะบัััั

#### EdgeTTS Speech Synthesis

- **ะขะตัะฝะพะปะพะณะธั**: Python + Microsoft Edge TTS
- **ะะพัั**: 5050
- **ะคัะฝะบัะธะธ**:
  - ะััะพะบะพะบะฐัะตััะฒะตะฝะฝัะน ัะธะฝัะตะท ัะตัะธ
  - ะะพะดะดะตัะถะบะฐ ะผะฝะพะถะตััะฒะตะฝะฝัั ัะทัะบะพะฒ ะธ ะณะพะปะพัะพะฒ
  - Streaming ะฐัะดะธะพ
  - ะะฝัะตะณัะฐัะธั ั Open WebUI

### ๐พ **Data Layer (Production Optimized)**

#### PostgreSQL 15.13 + pgvector 0.8.0

- **ะะตััะธั**: PostgreSQL 15.13 + pgvector 0.8.0 (Production Ready)
- **ะะพัั**: 5432 (ะฒะฝัััะตะฝะฝะธะน Docker network)
- **๐ Production ะบะพะฝัะธะณััะฐัะธั**:
  - **shared_buffers**: 256MB (ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะพ ะดะปั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ)
  - **max_connections**: 200 (ัะฒะตะปะธัะตะฝะพ ะดะปั ะฒััะพะบะพะน ะฝะฐะณััะทะบะธ)
  - **work_mem**: 4MB (ะพะฟัะธะผะฐะปัะฝะพ ะดะปั ัะปะพะถะฝัั ะทะฐะฟัะพัะพะฒ)
  - **wal_buffers**: 16MB (ัะปัััะตะฝะฝะฐั ะทะฐะฟะธัั WAL)
  - **maintenance_work_mem**: 64MB (ะฑัััััะน VACUUM ะธ ะธะฝะดะตะบัะธัะพะฒะฐะฝะธะต)
- **๐งน ะะฒัะพะฒะฐะบััะผ ะพะฟัะธะผะธะทะฐัะธั**:
  - **autovacuum_max_workers**: 4 (ะฐะณัะตััะธะฒะฝะฐั ะพัะธััะบะฐ)
  - **autovacuum_naptime**: 15s (ัะฐัััะต ะฟัะพะฒะตัะบะธ)
  - **autovacuum_vacuum_threshold**: 25 (ะฝะธะทะบะธะน ะฟะพัะพะณ)
- **๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั**:
  - **Cache hit ratio**: 99.76% (ะพัะปะธัะฝะฐั ัััะตะบัะธะฒะฝะพััั ะบััะฐ)
  - **ะัะตะผั ะพัะฒะตัะฐ**: <100ms ะดะปั 95% ะทะฐะฟัะพัะพะฒ
  - **ะะบัะธะฒะฝัะต ะฟะพะดะบะปััะตะฝะธั**: 1-5 (ะฝะธะทะบะฐั ะฝะฐะณััะทะบะฐ)
- **๐ ะะพะณะธัะพะฒะฐะฝะธะต**:
  - ะะบะปััะตะฝั connection/disconnection ะปะพะณะธ
  - ะะตะดะปะตะฝะฝัะต ะทะฐะฟัะพัั >100ms
  - Lock waits ะผะพะฝะธัะพัะธะฝะณ
- **๐ ะคัะฝะบัะธะธ**:
  - ะัะฝะพะฒะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั ะฟัะธะปะพะถะตะฝะธั (6 ะฟะพะปัะทะพะฒะฐัะตะปะตะน, 29 ัะฐัะพะฒ)
  - ะะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต ะดะปั RAG (968 ะฒะตะบัะพัะฝัั ัะฐะฝะบะพะฒ, 28MB)
  - ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ
  - ACID ััะฐะฝะทะฐะบัะธะธ
  - ะะฒัะพะผะฐัะธัะตัะบะธะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ

#### Redis 7.4.5 Stack

- **ะะตััะธั**: Redis 7.4.5 Stack (Production Optimized)
- **ะะพััั**: 6379 (Redis), 8001 (RedisInsight)
- **๐พ Memory Management**:
  - **maxmemory**: 2GB (ะฟัะตะดะพัะฒัะฐัะตะฝะธะต OOM)
  - **maxmemory-policy**: allkeys-lru (ัะผะฝะฐั ะพัะธััะบะฐ)
  - **ะขะตะบััะตะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต**: 2.20M (0.1% ะพั ะปะธะผะธัะฐ)
- **โก ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั**:
  - **SET ะพะฟะตัะฐัะธะธ**: <60ms
  - **GET ะพะฟะตัะฐัะธะธ**: <50ms
  - **ะะพะดะบะปััะตะฝะฝัะต ะบะปะธะตะฝัั**: 17 ะฐะบัะธะฒะฝัั
  - **ะะพะปะธัะตััะฒะพ ะบะปััะตะน**: 932 (ะฐะบัะธะฒะฝะพะต ะบััะธัะพะฒะฐะฝะธะต)
- **๐๏ธ ะกะธััะตะผะฝัะต ะพะฟัะธะผะธะทะฐัะธะธ**:
  - **vm.overcommit_memory=1** (ะธัะฟัะฐะฒะปะตะฝ memory overcommit warning)
  - ะะฒัะพัะพััะฐะฝะตะฝะธะต: 900s/1, 300s/100, 60s/10000 ะธะทะผะตะฝะตะฝะธะน
  - ะกัะฐะฑะธะปัะฝะฐั ัะฐะฑะพัะฐ ะฑะตะท ะฟัะตะดัะฟัะตะถะดะตะฝะธะน
- **๐ ะคัะฝะบัะธะธ**:
  - ะััะธัะพะฒะฐะฝะธะต ะฟะพะธัะบะพะฒัั ะทะฐะฟัะพัะพะฒ
  - ะกะตััะธะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน OpenWebUI
  - ะะพะฝัะธะณััะฐัะธะพะฝะฝัะต ะดะฐะฝะฝัะต
  - ะัะตะผะตะฝะฝัะต ะดะฐะฝะฝัะต ะพะฑัะฐะฑะพัะบะธ
  - Pub/Sub ะดะปั real-time ัะฒะตะดะพะผะปะตะฝะธะน

#### Backrest Backup System

- **ะขะตัะฝะพะปะพะณะธั**: Go + Restic
- **ะะพัั**: 9898
- **API Endpoints**: โ `/v1.Backrest/Backup`, `/v1.Backrest/GetOperations`
- **ะกัะฐััั**: โ ะััะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ะฝะฐัััะพะตะฝะพ (ะฐะฒะณััั 2025)
- **ะคัะฝะบัะธะธ**:
  - ะะฒัะพะผะฐัะธัะตัะบะธะต ะธะฝะบัะตะผะตะฝัะฐะปัะฝัะต ะฑัะบะฐะฟั (ะฟะปะฐะฝ "daily")
  - ะจะธััะพะฒะฐะฝะธะต ะดะฐะฝะฝัั AES-256
  - ะะตะดัะฟะปะธะบะฐัะธั ะธ ัะถะฐัะธะต
  - ะะตะฑ-ะธะฝัะตััะตะนั ัะฟัะฐะฒะปะตะฝะธั
  - ะะพัััะฐะฝะพะฒะปะตะฝะธะต ะฝะฐ ะพะฟัะตะดะตะปะตะฝะฝัั ะดะฐัั
  - REST API ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ

### ๐๏ธ **Infrastructure Layer (ะะฝััะฐััััะบัััะฐ)**

#### Watchtower Auto-updater

- **ะะพัั**: 8091
- **ะคัะฝะบัะธะธ**:
  - ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต Docker ะพะฑัะฐะทะพะฒ
  - ะะพะฝะธัะพัะธะฝะณ ะฝะพะฒัั ะฒะตััะธะน
  - Graceful ะฟะตัะตะทะฐะฟััะบ ัะตัะฒะธัะพะฒ
  - ะฃะฒะตะดะพะผะปะตะฝะธั ะพะฑ ะพะฑะฝะพะฒะปะตะฝะธัั
  - HTTP API ะดะปั ัะฟัะฐะฒะปะตะฝะธั

### ๐ **Monitoring Layer (ะะพะฝะธัะพัะธะฝะณ)**

#### Prometheus Metrics Server

- **ะะตััะธั**: v2.48.0
- **ะะพัั**: 9091
- **ะคัะฝะบัะธะธ**:
  - ะกะฑะพั ะผะตััะธะบ ัะพ ะฒัะตั ัะตัะฒะธัะพะฒ
  - Time-series ะฑะฐะทะฐ ะดะฐะฝะฝัั
  - Alerting rules
  - Service discovery
  - 30-ะดะฝะตะฒะฝะพะต ััะฐะฝะตะฝะธะต ะดะฐะฝะฝัั

#### Grafana Dashboards

- **ะะตััะธั**: 10.2.0
- **ะะพัั**: 3000
- **ะคัะฝะบัะธะธ**:
  - ะะธะทัะฐะปะธะทะฐัะธั ะผะตััะธะบ
  - ะะฝัะตัะฐะบัะธะฒะฝัะต ะดะฐัะฑะพัะดั
  - Alerting ะธ ัะฒะตะดะพะผะปะตะฝะธั
  - ะะพะปัะทะพะฒะฐัะตะปััะบะธะต ะฟะฐะฝะตะปะธ
  - ะะฝัะตะณัะฐัะธั ั Prometheus

#### AlertManager

- **ะะตััะธั**: v0.26.0
- **ะะพััั**: 9093, 9094
- **ะคัะฝะบัะธะธ**:
  - ะฃะฟัะฐะฒะปะตะฝะธะต ะฐะปะตััะฐะผะธ
  - ะััะฟะฟะธัะพะฒะบะฐ ัะฒะตะดะพะผะปะตะฝะธะน
  - ะะฐัััััะธะทะฐัะธั ะฐะปะตััะพะฒ
  - ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะธะผะธ ัะธััะตะผะฐะผะธ
  - Silencing ะธ inhibition

#### Webhook Receiver

- **ะขะตัะฝะพะปะพะณะธั**: Python Flask
- **ะะพัั**: 9095 (ะฒะฝะตัะฝะธะน), 9093 (ะฒะฝัััะตะฝะฝะธะน)
- **ะคัะฝะบัะธะธ**:
  - ะะฑัะฐะฑะพัะบะฐ ะฐะปะตััะพะฒ ะพั AlertManager
  - ะะพะณะธัะพะฒะฐะฝะธะต ะบัะธัะธัะตัะบะธั ัะพะฑััะธะน
  - ะัะฟะพะปะฝะตะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะธั ะดะตะนััะฒะธะน
  - ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะธะผะธ ัะธััะตะผะฐะผะธ ัะฒะตะดะพะผะปะตะฝะธะน
  - JSON ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ะฐะปะตััะพะฒ

#### Node Exporter

- **ะะตััะธั**: v1.7.0
- **ะะพัั**: 9101
- **ะคัะฝะบัะธะธ**:
  - ะกะธััะตะผะฝัะต ะผะตััะธะบะธ ัะพััะฐ
  - CPU, ะฟะฐะผััั, ะดะธัะบ, ัะตัั
  - ะัะพัะตััั ะธ systemd ัะตัะฒะธัั
  - Hardware ะผะพะฝะธัะพัะธะฝะณ

#### PostgreSQL Exporter

- **ะะตััะธั**: v0.15.0
- **ะะพัั**: 9187
- **ะคัะฝะบัะธะธ**:
  - ะะตััะธะบะธ ะฑะฐะทั ะดะฐะฝะฝัั
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะทะฐะฟัะพัะพะฒ
  - ะกะพะตะดะธะฝะตะฝะธั ะธ ะฑะปะพะบะธัะพะฒะบะธ
  - ะะตะฟะปะธะบะฐัะธั ะธ ะฑัะบะฐะฟั

#### Redis Exporter

- **ะะตััะธั**: v1.55.0
- **ะะพัั**: 9121
- **ะคัะฝะบัะธะธ**:
  - ะะตััะธะบะธ Redis ัะตัะฒะตัะฐ
  - ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะฟะฐะผััะธ
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะบะพะผะฐะฝะด
  - Keyspace ััะฐัะธััะธะบะฐ

#### NVIDIA GPU Exporter

- **ะะตััะธั**: 0.1
- **ะะพัั**: 9445
- **ะคัะฝะบัะธะธ**:
  - GPU ััะธะปะธะทะฐัะธั
  - ะะฐะผััั GPU
  - ะขะตะผะฟะตัะฐัััะฐ ะธ ัะฝะตัะณะพะฟะพััะตะฑะปะตะฝะธะต
  - CUDA ะฟัะพัะตััั

#### Blackbox Exporter

- **ะะตััะธั**: v0.24.0
- **ะะพัั**: 9115
- **ะคัะฝะบัะธะธ**:
  - ะะพะฝะธัะพัะธะฝะณ ะดะพัััะฟะฝะพััะธ ัะตัะฒะธัะพะฒ
  - HTTP/HTTPS ะฟัะพะฒะตัะบะธ
  - TCP/UDP connectivity
  - SSL ัะตััะธัะธะบะฐัั

#### cAdvisor Container Metrics

- **ะะตััะธั**: v0.47.2
- **ะะพัั**: 8081
- **ะคัะฝะบัะธะธ**:
  - ะะตััะธะบะธ ะบะพะฝัะตะนะฝะตัะพะฒ
  - ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั I/O
  - Network ััะฐัะธััะธะบะฐ

#### Ollama AI Exporter

- **ะะตััะธั**: Custom Python exporter
- **ะะพัั**: 9778
- **ะคัะฝะบัะธะธ**:
  - ะะพะฝะธัะพัะธะฝะณ AI ะผะพะดะตะปะตะน (`ollama_models_total`)
  - ะะฐะทะผะตัั ะผะพะดะตะปะตะน (`ollama_model_size_bytes`)
  - ะะตััะธั Ollama (`ollama_info`)
  - ะกัะฐััั GPU ะธัะฟะพะปัะทะพะฒะฐะฝะธั
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะธะฝัะตัะตะฝัะฐ

#### Nginx Web Exporter

- **ะะตััะธั**: nginx/nginx-prometheus-exporter:1.1.0
- **ะะพัั**: 9113
- **ะคัะฝะบัะธะธ**:
  - HTTP ะผะตััะธะบะธ ะฒะตะฑ-ัะตัะฒะตัะฐ
  - ะะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ัะพะตะดะธะฝะตะฝะธะน
  - ะกัะฐัะธััะธะบะฐ ะทะฐะฟัะพัะพะฒ/ะพัะฒะตัะพะฒ
  - ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั upstream'ะพะฒ
  - Rate limiting ะผะตััะธะบะธ

#### Fluent Bit Log Collector

- **ะะตััะธั**: fluent/fluent-bit:2.2.0
- **ะะพัั**: 2020 (ะผะตััะธะบะธ)
- **ะคัะฝะบัะธะธ**:
  - ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัะน ัะฑะพั ะปะพะณะพะฒ
  - ะะฐััะธะฝะณ ะธ ัะธะปัััะฐัะธั ะปะพะณะพะฒ
  - ะัะฟัะฐะฒะบะฐ ะฒ Loki
  - ะะตััะธะบะธ ะพะฑัะฐะฑะพัะบะธ ะปะพะณะพะฒ

#### Loki Log Aggregation

- **ะะตััะธั**: grafana/loki:2.9.0
- **ะะพัั**: 3100
- **ะคัะฝะบัะธะธ**:
  - ะฅัะฐะฝะตะฝะธะต ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัั ะปะพะณะพะฒ
  - ะะฝัะตะณัะฐัะธั ั Grafana ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ
  - ะญััะตะบัะธะฒะฝะพะต ัะถะฐัะธะต ะธ ะธะฝะดะตะบัะธัะพะฒะฐะฝะธะต
  - LogQL ะดะปั ะทะฐะฟัะพัะพะฒ ะปะพะณะพะฒ
  - ะกะพะฒะผะตััะธะผะพััั ั Prometheus ะผะตััะธะบะฐะผะธ

## ๐ ะกะตัะตะฒะฐั ะฐััะธัะตะบัััะฐ

### ะะพััั ะธ ะฟัะพัะพะบะพะปั

| ะกะตัะฒะธั                         | ะะฝะตัะฝะธะน ะฟะพัั  | ะะฝัััะตะฝะฝะธะน ะฟะพัั | ะัะพัะพะบะพะป   | ะะฐะทะฝะฐัะตะฝะธะต            |
| ------------------------------ | ------------- | --------------- | ---------- | --------------------- |
| nginx                          | 80, 443, 8080 | 80, 443, 8080   | HTTP/HTTPS | Web gateway           |
| auth                           | -             | 9090            | HTTP       | JWT validation        |
| openwebui                      | -             | 8080            | HTTP/WS    | AI interface          |
| ollama                         | -             | 11434           | HTTP       | LLM API               |
| litellm                        | 4000          | 4000            | HTTP       | LLM proxy             |
| db                             | -             | 5432            | PostgreSQL | Database              |
| redis                          | -             | 6379, 8001      | Redis/HTTP | Cache & UI            |
| searxng                        | -             | 8080            | HTTP       | Search API            |
| mcposerver                     | -             | 8000            | HTTP       | MCP protocol          |
| docling                        | -             | 5001            | HTTP       | Document parsing      |
| tika                           | -             | 9998            | HTTP       | Metadata extraction   |
| edgetts                        | -             | 5050            | HTTP       | Speech synthesis      |
| backrest                       | 9898          | 9898            | HTTP       | Backup management     |
| cloudflared                    | -             | -               | HTTPS      | Tunnel service        |
| watchtower                     | 8091          | 8080            | HTTP       | Auto-updater          |
| prometheus                     | 9091          | 9090            | HTTP       | Metrics collection    |
| grafana                        | 3000          | 3000            | HTTP       | Monitoring dashboards |
| alertmanager                   | 9093, 9094    | 9093, 9094      | HTTP       | Alert management      |
| webhook-receiver               | 9095          | 9093            | HTTP       | Alert processing      |
| node-exporter                  | 9101          | 9100            | HTTP       | System metrics        |
| postgres-exporter              | 9187          | 9187            | HTTP       | PostgreSQL metrics    |
| Redis ะผะพะฝะธัะพัะธะฝะณ ัะตัะตะท Grafana | 9121          | 9121            | HTTP       | Redis metrics         |
| nvidia-exporter                | 9445          | 9445            | HTTP       | GPU metrics           |
| blackbox-exporter              | 9115          | 9115            | HTTP       | Endpoint monitoring   |
| cadvisor                       | 8081          | 8080            | HTTP       | Container metrics     |

### Docker Networks

- **erni-ki_default**: ะัะฝะพะฒะฝะฐั ัะตัั ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- **ะะทะพะปััะธั**: ะะฐะถะดัะน ัะตัะฒะธั ะดะพัััะฟะตะฝ ัะพะปัะบะพ ะฟะพ ะธะผะตะฝะธ ะบะพะฝัะตะนะฝะตัะฐ
- **DNS**: ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฐะทัะตัะตะฝะธะต ะธะผะตะฝ ัะตัะตะท Docker DNS

## ๐ ะะพัะพะบะธ ะดะฐะฝะฝัั

### ะะพะปัะทะพะฒะฐัะตะปััะบะธะน ะทะฐะฟัะพั

1. **Browser** โ **Cloudflare** โ **Cloudflared** โ **Nginx**
2. **Nginx** โ **Auth Service** (ะฒะฐะปะธะดะฐัะธั JWT)
3. **Nginx** โ **Open WebUI** (ะพัะฝะพะฒะฝะพะน ะธะฝัะตััะตะนั)
4. **Open WebUI** โ **Ollama** (ะณะตะฝะตัะฐัะธั ะพัะฒะตัะฐ)
5. **Open WebUI** โ **PostgreSQL** (ัะพััะฐะฝะตะฝะธะต ะธััะพัะธะธ)

### RAG ะฟะพะธัะบ

1. **Open WebUI** โ **SearXNG** (ะฟะพะธัะบ ะธะฝัะพัะผะฐัะธะธ)
2. **SearXNG** โ **Redis** (ะบััะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ)
3. **Open WebUI** โ **PostgreSQL/pgvector** (ะฒะตะบัะพัะฝัะน ะฟะพะธัะบ)
4. **Open WebUI** โ **Ollama** (ะณะตะฝะตัะฐัะธั ั ะบะพะฝัะตะบััะพะผ)

### ะะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ

1. **Open WebUI** โ **Docling/Tika** (ะฟะฐััะธะฝะณ ะดะพะบัะผะตะฝัะฐ)
2. **Open WebUI** โ **PostgreSQL/pgvector** (ัะพััะฐะฝะตะฝะธะต ะฒะตะบัะพัะพะฒ)
3. **Open WebUI** โ **Ollama** (ะฐะฝะฐะปะธะท ัะพะดะตัะถะธะผะพะณะพ)

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะฝะฐะฑะปัะดะฐะตะผะพััั

### Health Checks

- ะัะต ัะตัะฒะธัั ะธะผะตัั ะฝะฐัััะพะตะฝะฝัะต health checks
- ะะฒัะพะผะฐัะธัะตัะบะธะน ะฟะตัะตะทะฐะฟััะบ ะฟัะธ ัะฑะพัั
- ะะพะฝะธัะพัะธะฝะณ ัะตัะตะท `docker compose ps`

### ะะพะณะธัะพะฒะฐะฝะธะต

- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัะต ะปะพะณะธ ัะตัะตะท Docker logging driver
- ะะพัะฐัะธั ะปะพะณะพะฒ ะดะปั ะฟัะตะดะพัะฒัะฐัะตะฝะธั ะฟะตัะตะฟะพะปะฝะตะฝะธั ะดะธัะบะฐ
- ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะฒ JSON ัะพัะผะฐัะต

### ะะตััะธะบะธ

- ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ ัะตัะตะท `docker stats`
- ะะพะฝะธัะพัะธะฝะณ GPU ัะตัะตะท nvidia-smi
- ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะฑะฐะทั ะดะฐะฝะฝัั

## ๐ง ะะพะฝัะธะณััะฐัะธั ะธ ัะฐะทะฒะตัััะฒะฐะฝะธะต

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

- ะะฐะถะดัะน ัะตัะฒะธั ะธะผะตะตั ะพัะดะตะปัะฝัะน `.env` ัะฐะนะป
- ะกะตะบัะตัะฝัะต ะบะปััะธ ะณะตะฝะตัะธัััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- ะะพะฝัะธะณััะฐัะธั ัะตัะตะท Docker Compose

### ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

- ะะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต ัะตัะตะท Docker Compose scale
- ะะฐะปะฐะฝัะธัะพะฒะบะฐ ะฝะฐะณััะทะบะธ ัะตัะตะท Nginx upstream
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะฐััะถะตะฝะธะต ะฝะพะฒัั ัะบะทะตะผะฟะปััะพะฒ

### ะะตะทะพะฟะฐัะฝะพััั

- ะะธะฝะธะผะฐะปัะฝัะต ะฟัะธะฒะธะปะตะณะธะธ ะดะปั ะฒัะตั ะบะพะฝัะตะนะฝะตัะพะฒ
- ะะทะพะปััะธั ัะตัะตะน ะธ ัะฐะนะปะพะฒัั ัะธััะตะผ
- ะะตะณัะปััะฝัะต ะพะฑะฝะพะฒะปะตะฝะธั ะฑะตะทะพะฟะฐัะฝะพััะธ ัะตัะตะท Watchtower

## ๐ ะะพัะปะตะดะฝะธะต ะธะทะผะตะฝะตะฝะธั ะฐััะธัะตะบัััั

### ะะฒะณััั 2025 - ะะตััะธั 6.0

#### โ ะัะฟัะฐะฒะปะตะฝะธั ะธ ะพะฟัะธะผะธะทะฐัะธะธ

**SearXNG RAG ะธะฝัะตะณัะฐัะธั:**

- ะัะบะปััะตะฝ DuckDuckGo ะดะฒะธะถะพะบ ะธะท-ะทะฐ CAPTCHA ะฑะปะพะบะธัะพะฒะบะธ
- ะะบัะธะฒะฝัะต ะดะฒะธะถะบะธ: Startpage, Brave, Bing
- ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั: <3 ัะตะบัะฝะดั, 60+ ัะตะทัะปััะฐัะพะฒ
- ะกัะฐััั: โ ะะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปัะฝะฐ

**Backrest API:**

- ะะตัะตัะพะด ะฝะฐ JSON RPC endpoints (`/v1.Backrest/*`)
- ะะพัััะฐะฝะพะฒะปะตะฝ ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัะน ะผะพะฝะธัะพัะธะฝะณ
- API endpoints: GetOperations, GetConfig ัะฐะฑะพัะฐัั ะบะพััะตะบัะฝะพ
- ะกัะฐััั: โ ะะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปะตะฝ

**Ollama ะผะพะดะตะปะธ:**

- ะะพะฑะฐะฒะปะตะฝะฐ qwen2.5-coder:1.5b (986MB) ะดะปั ะบะพะดะธัะพะฒะฐะฝะธั
- ะัะตะณะพ 6 ะผะพะดะตะปะตะน: qwen2.5:0.5b, qwen2.5-coder:1.5b, phi4-mini-reasoning:3.8b,
  gemma3n:e4b, deepseek-r1:7b, nomic-embed-text
- GPU ะธัะฟะพะปัะทะพะฒะฐะฝะธะต: 31% VRAM (1610MB/5120MB)
- ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั: ~1.5 ัะตะบัะฝะดั ะณะตะฝะตัะฐัะธั

**ะะพะฝะธัะพัะธะฝะณ:**

- **35/35 Prometheus targets ะฐะบัะธะฒะฝั** (100% ััะฟะตั)
- ะัะต 29 ERNI-KI ัะตัะฒะธัะพะฒ ะทะดะพัะพะฒั
- ะกะธััะตะผะฐ ัะฐะฑะพัะฐะตั ะฝะฐ 100% ะพั ะพะฟัะธะผะฐะปัะฝะพะณะพ ััะพะฒะฝั
- AI ะผะตััะธะบะธ: 3 ะผะพะดะตะปะธ ะผะพะฝะธัะพััััั (nomic-embed-text, gpt-oss, gemma3n)
- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ัะตัะตะท Fluent-bit โ Loki

#### ๐ ะขะตะบััะธะน ััะฐััั ัะธััะตะผั

- **ะะฑัะฐั ะพัะตะฝะบะฐ:** ๐ข ะะะะะะกะฅะะะะ (100/100)
- **ะกะตัะฒะธัั:** 29/29 ERNI-KI ัะตัะฒะธัะพะฒ ะทะดะพัะพะฒั
- **HTTPS ะดะพัััะฟ:** โ HTTP/2 ัะฐะฑะพัะฐะตั
- **GPU ััะบะพัะตะฝะธะต:** โ ะะบัะธะฒะฝะพ + ะผะพะฝะธัะพัะธะฝะณ
- **RAG ะธะฝัะตะณัะฐัะธั:** โ <2 ัะตะบัะฝะดั
- **ะะพะฝะธัะพัะธะฝะณ:** โ ะะพะปะฝัะน ััะตะบ 35 targets
- **AI ะผะตััะธะบะธ:** โ Ollama + ะผะพะดะตะปะธ
- **ะะตะฑ-ะฐะฝะฐะปะธัะธะบะฐ:** โ Nginx ะผะตััะธะบะธ
- **ะะพะณะธัะพะฒะฐะฝะธะต:** โ ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต
- **ะัะบะฐะฟั:** โ 7-ะดะฝะตะฒะฝัะต + 4-ะฝะตะดะตะปัะฝัะต

---

**๐ ะัะธะผะตัะฐะฝะธะต**: ะะฐะฝะฝะฐั ะฐััะธัะตะบัััะฐ ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ ะดะปั production
ะธัะฟะพะปัะทะพะฒะฐะฝะธั ั ะฐะบัะตะฝัะพะผ ะฝะฐ ะฑะตะทะพะฟะฐัะฝะพััั, ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะธ ะฝะฐะดะตะถะฝะพััั.
