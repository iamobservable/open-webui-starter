# ERNI-KI Logging System Audit ‚Äî 2025-11-14

## Scope & Method

- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `erni-ki`
  (`/home/konstantin/Documents/augment-projects/erni-ki`).
- –û–±–ª–∞—Å—Ç—å: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (Docker Compose, Fluent Bit, Loki,
  –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã).
- –ú–µ—Ç–æ–¥–∏–∫–∞: –∞–Ω–∞–ª–∏–∑ `compose.yml`, `conf/fluent-bit/*`,
  `conf/loki/loki-config.yaml`, `env/*`, –∞ —Ç–∞–∫–∂–µ —É—Ç–∏–ª–∏—Ç
  `scripts/core/maintenance/log-rotation-manager.sh` –∏
  `scripts/utilities/log-monitoring.sh`. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
  ‚Äî —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ª–æ–≥–æ–≤ –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å.

## –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Å—Ä–µ–∑)

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ 4 –ø—Ä–æ—Ñ–∏–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (`compose.yml:6-58`). –¢–æ–ª—å–∫–æ
  —É—Ä–æ–≤–Ω–∏ 1‚Äì2 –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Docker `fluentd` driver –≤ Fluent Bit ‚Üí Loki;
  —É—Ä–æ–≤–Ω–∏ 3‚Äì4 –ø–∏—à—É—Ç –≤ `json-file`.
- Fluent Bit —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (`compose.yml:986-1029`) —Å
  –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –≤—Ö–æ–¥–æ–º `forward` –∏ –≤—ã–≤–æ–¥–∞–º–∏ –≤ Loki + Prometheus
  (`conf/fluent-bit/fluent-bit.conf:35-120, 180-210`).
- Loki —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–¥–∏–Ω–æ—á–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ —Å —Ñ–∞–π–ª–æ–≤—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º `./data/loki` –∏ –±–µ–∑
  –Ω–∞—Å—Ç—Ä–æ–µ–∫ retention/compaction —Å–≤–µ—Ä—Ö —É–º–æ–ª—á–∞–Ω–∏–π
  (`conf/loki/loki-config.yaml:1-48`).
- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (`scripts/core/maintenance/log-rotation-manager.sh` –∏
  `scripts/utilities/log-monitoring.sh`) —Ä–∞–±–æ—Ç–∞—é—Ç —Å `docker logs`,
  `docker-compose` –∏ –∫–∞—Ç–∞–ª–æ–≥–∏ `/var/lib/docker/containers`, –ø–æ–ª–∞–≥–∞—è—Å—å –Ω–∞ —Ä—É—á–Ω—ã–µ
  cron-–∑–∞–¥–∞—á–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏

| Severity  | –û–±–ª–∞—Å—Ç—å                      | –ü—Ä–æ–±–ª–µ–º–∞                                                                                                                                                                                                                                                                                                                                                       | –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ                                                                                                                 | –í–ª–∏—è–Ω–∏–µ |
| --------- | ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------ | ------- |
| üî¥ High   | –ü–æ–∫—Ä—ã—Ç–∏–µ –ª–æ–≥–æ–≤               | Docling, EdgeTTS, Tika, MCP –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ `json-file` –¥—Ä–∞–π–≤–µ—Ä (`compose.yml:32-50` + `compose.yml:503-538`, `compose.yml:878-910`), –∞ Fluent Bit —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ `forward` (`conf/fluent-bit/fluent-bit.conf:35-46`). –≠—Ç–∏ –ª–æ–≥–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Loki/Grafana –∏ –∂–∏–≤—É—Ç –ª–∏—à—å –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö.                            | –ù–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞/–∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ –ø–æ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø—Ä–∏ —Å–±–æ–µ –Ω–æ–¥—ã.                        |
| üî¥ High   | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏          | –ö–æ–Ω—Ñ–∏–≥ Fluent Bit –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –Ω–∏ `tail`/`docker` input, –Ω–∏ `multiline` –ø–∞—Ä—Å–µ—Ä (`conf/fluent-bit/fluent-bit.conf:35-140`), –∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≥–æ—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤/—Å–∫—Ä–∏–ø—Ç–æ–≤ (`conf/fluent-bit/filters-optimized.conf`, `conf/fluent-bit/scripts/service_parser.lua`). –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Å—Ç–µ–∫–∏ trace‚Äô–æ–≤ —Ä–≤—É—Ç—Å—è, —Å–µ—Ä–≤–∏—Å/–∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è, PII –Ω–µ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è. | –°—ã—Ä–∞—è, —à—É–º–Ω–∞—è –ª–µ–Ω—Ç–∞ –ª–æ–≥–æ–≤ ‚Üí –Ω–∏–∑–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∏—Å–∫ —É—Ç–µ—á–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫.                                         |
| üî¥ High   | –•—Ä–∞–Ω–∏–ª–∏—â–µ                    | Loki –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ –±–µ–∑ retention/compactor –æ–ø—Ü–∏–π (`conf/loki/loki-config.yaml:8-48`). –û–±—ä—ë–º `./data/loki` —Ä–∞—Å—Ç—ë—Ç –±–µ—Å–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç.                                                                                                                                                                          | –ü–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ª–æ–≥–æ–≤ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∏—Å–∫–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ RTO/RPO; Loki ‚Äî single point of failure.                            |
| üü† Medium | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –¥—Ä–µ–π—Ñ–æ–≤–∞–Ω–∏–µ | `env/fluent-bit.env` —Å–æ–¥–µ—Ä–∂–∏—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø–æ–ª—è (Elasticsearch, Kubernetes, TLS Off) –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ (`conf/fluent-bit/fluent-bit.conf` –∂—ë—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω).                                                                                                                                                                                         | –¢—Ä—É–¥–Ω–æ –ø–æ–Ω—è—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –≤–µ–ª–∏–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–∏—Ç—å—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–π.                   |
| üü† Medium | –°–∫—Ä–∏–ø—Ç—ã –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è         | `scripts/core/maintenance/log-rotation-manager.sh:64-158` –∏ `scripts/utilities/log-monitoring.sh:57-200` —á–∏—Ç–∞—é—Ç `/var/lib/docker/containers/*-json.log`, –≥–æ–Ω—è—é—Ç `docker logs` –∏ `docker-compose`, —Ç—Ä–µ–±—É—é—Ç root-–¥–æ—Å—Ç—É–ø –∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.                                                                                                 | –†—É—á–Ω—ã–µ cron-–∑–∞–¥–∞—á–∏ –Ω–µ—Å—Ç—ã–∫—É—é—Ç—Å—è —Å Docker logging driver‚Äô–æ–º; –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∞/–≥–æ–Ω–∫–∏ –∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. |
| üü† Medium | –ü—Ä–∏–∫–ª–∞–¥–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã           | –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å (`auth/main.go:19-70`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `gin.Logger()` ‚Üí plaintext stdout –±–µ–∑ `request_id`, `span_id`, `user` –∏ –¥–∞–∂–µ `LOG_LEVEL` –∏–∑ `env/auth.env`. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è OpenWebUI/LiteLLM –Ω–µ—Ç –ø—Ä–æ–∫—Å–∏, –∫–æ—Ç–æ—Ä—ã–π –±—ã –≤–Ω–µ–¥—Ä—è–ª –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã.                                                                                     | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –º–µ–∂–¥—É API, –ø—Ä–æ–∫—Å–∏ –∏ —Ñ–æ–Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏. –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.        |
| üü° Low    | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å                 | –í `conf/fluent-bit/fluent-bit.conf` –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ñ–∏–ª—å—Ç—Ä—ã –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤/–ø–∞—Ä–æ–ª–µ–π (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ `filters-optimized.conf`), –∞ HTTP-–ø–æ—Ä—Ç—ã Fluent Bit/Loki –ø—Ä–æ–±—Ä–æ—à–µ–Ω—ã –Ω–∞ localhost –±–µ–∑ TLS (`compose.yml:1022-1025`, `compose.yml:657-676`).                                                                                                     | –õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Å —Ö–æ—Å—Ç–∞; PII –∏ —Å–µ–∫—Ä–µ—Ç—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ Loki –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ.                                                 |

## –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –≠—Ç–∞–ø 0 ‚Äî –ë—ã—Å—Ç—Ä—ã–µ –ø–æ–±–µ–¥—ã (1‚Äì2 –¥–Ω—è)

1. **–í—ã—Ä–∞–≤–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**: —É–¥–∞–ª–∏—Ç—å –º—ë—Ä—Ç–≤—ã–µ —Ñ–∞–π–ª—ã
   (`conf/fluent-bit/filters-optimized.conf`, `filters-log-optimization.conf`,
   `scripts/service_parser.lua`) –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏—Ö –≤ `fluent-bit.conf`;
   —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å `env/fluent-bit.env` —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
2. **–†–∞—Å—à–∏—Ä–∏—Ç—å –≤—Ö–æ–¥—ã Fluent Bit**: –¥–æ–±–∞–≤–∏—Ç—å `Tail`/`Docker` input —Å
   `Path /var/lib/docker/containers/*/*.log` –∏ `Parser docker` + `multiline`
   –ø–∞—Ä—Å–µ—Ä, —á—Ç–æ–±—ã –æ—Ö–≤–∞—Ç–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –µ–¥–∏–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä.
3. **–í–∫–ª—é—á–∏—Ç—å –±–∞–∑–æ–≤—É—é –º–∞—Å–∫–∏—Ä–æ–≤–∫—É**: –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ–∫—Ü–∏—é `modify/Replace` –∏–∑
   `filters-optimized` –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ –∏ –Ω–∞—á–∞—Ç—å —á–∏—Å—Ç–∏—Ç—å `password`, `token`,
   `api_key`, `authorization`.

### –≠—Ç–∞–ø 1 ‚Äî –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å (1 –Ω–µ–¥–µ–ª—è)

1. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å logging driver**: –æ–±–Ω–æ–≤–∏—Ç—å `compose.yml` —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Å–µ
   —Å–µ—Ä–≤–∏—Å—ã —É—Ä–æ–≤–Ω—è 3‚Äì4 —Ç–æ–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Fluent Bit (e.g.
   `logging: *important-logging` + `fluentd-async`/`fluentd-ack`). –î–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤,
   –≥–¥–µ –Ω—É–∂–µ–Ω fallback, –ø–æ–¥–∫–ª—é—á–∏—Ç—å dual logging (`fluentd` + `max-file`).
2. **–û–±–Ω–æ–≤–∏—Ç—å Fluent Bit pipeline**: –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å Lua `service_parser`,
   –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–∫–∏ (`service`, `service_category`, `environment`,
   `correlation_id`), –≤–∫–ª—é—á–∏—Ç—å `Throttle`, `Dedupe`, `Multiline` –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π
   JSON output.
3. **–ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–ª–µ—Ä—Ç—ã**: —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å Prometheus –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –ø–æ—Ä—Ç 2021 –∏
   –¥–æ–±–∞–≤–∏—Ç—å alert‚Äô—ã `FluentBitDeliveryErrors`, `FluentBitStorageUsage`,
   `LogsDropped`.

### –≠—Ç–∞–ø 2 ‚Äî –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (1‚Äì2 –Ω–µ–¥–µ–ª–∏)

1. **–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ Loki –≤ S3/MinIO**: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `schema_config` –∏ `storage_config`
   –¥–ª—è –æ–±—ä–µ–∫—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –≤–∫–ª—é—á–∏—Ç—å compactor + retention (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30‚ÄØ–¥–Ω–µ–π –≤
   hot storage, 180‚ÄØ–¥–Ω–µ–π –≤ archive).
2. **TLS –∏ RBAC**: –∑–∞–∫—Ä—ã—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã `2020/24224/3100`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–∫—É
   `logging-net` + mTLS Fluent Bit ‚Üí Loki –∏ HTTP basic auth/Grafana datasource
   tokens.
3. **–ë—ç–∫–∞–ø—ã**: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞–ø—à–æ—Ç—ã Loki chunks –∏ Fluent Bit DB
   (`data/fluent-bit/db`) —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ `scripts/maintenance`.

### –≠—Ç–∞–ø 3 ‚Äî –ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —É—Ä–æ–≤–µ–Ω—å –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (2 –Ω–µ–¥–µ–ª–∏)

1. **–í–Ω–µ–¥—Ä–∏—Ç—å correlation IDs**: –¥–æ–±–∞–≤–∏—Ç—å middleware –≤ nginx, auth (Gin),
   OpenWebUI proxy –∏ LiteLLM entrypoint, —á—Ç–æ–±—ã –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å/–ø—Ä–æ–∫–∏–¥—ã–≤–∞—Ç—å
   `x-request-id` –∏ `trace_id`.
2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ª–æ–≥–æ–≤**: –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
   (`timestamp`, `service`, `component`, `severity`, `request_id`, `span_id`,
   `user_id_hash`, `message`, `fields`), –æ–±–Ω–æ–≤–∏—Ç—å env/templates –∏ –¥–æ–±–∞–≤–∏—Ç—å
   –ª–∏–Ω—Ç–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `scripts/utilities/log-schema-verify.sh`).
3. **–£–¥–∞–ª–∏—Ç—å —Ä—É—á–Ω—ã–µ —Ä–æ—Ç–∞—Ü–∏–∏**: –∑–∞–º–µ–Ω–∏—Ç—å
   `scripts/core/maintenance/log-rotation-manager.sh` –∏ –ø–æ–¥–æ–±–Ω—ã–µ cron-–∑–∞–¥–∞–Ω–∏—è –Ω–∞
   –ø–æ–ª–∏—Ç–∏–∫–∏ Fluent Bit + Loki retention; –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞ –∏
   health-check –∂—ë—Å—Ç–∫–æ –≤ Prometheus.

### –≠—Ç–∞–ø 4 ‚Äî –ü–æ–ª–∏—Ç–∏–∫–∏ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è (–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ)

1. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ runbooks**: –æ–±–Ω–æ–≤–∏—Ç—å `docs/operations/monitoring-guide.md` –∏
   `docs/log-audit-2025-11-14.md`, –æ–ø–∏—Å–∞–≤ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
   –∫–æ–º–∞–Ω–¥ –∏ —á–µ–∫-–ª–∏—Å—Ç—ã –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤.
2. **–û–±—É—á–µ–Ω–∏–µ**: –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–æ—Ä–∫—à–æ–ø –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ best practices
   —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ redaction.
3. **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –∞—É–¥–∏—Ç**: —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª –ø—Ä–æ–≥–æ–Ω—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç (e.g.
   `scripts/monitoring/logging-baseline.sh`) –∏ —Ä–µ–≤—å—é–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã/retention.

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- 100‚ÄØ% –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤–∏–¥–Ω—ã –≤ Loki (dashboards + alert).
- <1‚ÄØ% —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ dropped/retried –≤ Fluent Bit.
- Retention ‚â•30 –¥–Ω–µ–π –±–µ–∑ —Ä—É—á–Ω—ã—Ö —á–∏—Å—Ç–æ–∫ –Ω–∞ –¥–∏—Å–∫–µ.
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–±–∞–≤–ª—è—é—Ç `request_id` –∏ `service` –ø–æ–ª—è.
- –ù–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö TCP-–ø–æ—Ä—Ç–æ–≤ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ host-only –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö.
